
<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/index.css" media="screen">
    <link rel="stylesheet" type="text/css" href="css/productListing.css" media="screen">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title> </title>

    
</head>

<body onload="initialize()">
<div class="header">
    <h1>Tom Narainpursat</h1>
    <h4>
        Modern Front End Developer
        </br>
        <span class='quote'>"Where ever you go that's where you are"</span>
    </h4>
</div>

<div class='nav'>
    <h3>Menu</h3>
    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="Button.html">Button</a></li>
        <li><a href="SideBar.html">Profile Card</a></li>
        <li><a href="Signup.html">Signup</a></li>
        <li><a href="Search.html">Search</a></li>
        <li><a href="Questionairre.html">Questionaire</a></li>
        <li><a href="Login.html">Login</a></li>
        <li><a href="Colours.html">Colour Builder</a></li>
        <li><a href="ShippingBilling.html">Shipping & Billing</a></li>
        <li><a href="CreditDebitCard.html">Payment Info</a></li>
        <li><a href="Calculator.html">Calculator</a></li>
        <li><a href="ProductListing.html">Products</a></li>
    </ul>

</div>
<div id='content'>
    <div class='products_main'>
        <div class='row'>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$5.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$10.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$20.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$1.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
        </div>
        <div class='row'>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$2.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$3.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
        </div>
        <div class='row'>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
            <div class='product_container'>
                <img src="http://placehold.it/140x100" class='product_image'>
                </br>
                <span class="itemName">Product Name</span>
                </br>
                Price : <span class="itemPrice">$0.00</span>
                </br>
                Qty: <input type="text" class='qty' value='1'></input>
                <button onclick="addItemToCart(this)">Add to Cart</button>
            </div>
        </div>
    </div>
    <div class='cart'>
        <button id="cartToggle" onclick="toggleCart(this);">Hide Cart</button>
        <table>
            <thead>
            <tr>
                <th colspan='4'>
                    <h4>Cart</h4>
                </th>
            </tr>

            <tr>
                <th></th>
                <th>Item </th>
                <th>Qty</th>
                <th>Total</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td colspan='2'>
                    Total
                <td>
                <td id="cartTotal" colspan='1'>$0.00</td>
            </tr>
            <tr>
                <td colspan ='4'><button onclick="calculateCartItems()">Add Coupon Code</button><input type='text' class='coupon'></input></td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
                <td colspan ='4'><button class='btn_max'>Checkout</button></td>
            </tr>
            <tr>
                <td colspan ='4'><button class='btn_max'>Continue Shopping</button></td>
            </tr>
            </tfoot>
        </table>
    </div>
</div>
</div>

<script>
    function initialize() {
        var productEls = document.getElementsByClassName("product_container");
        for (var i=0; i<productEls.length; i++) {
            productEls[i].setAttribute("productId", i+1);
        }

        document.getElementById("cartToggle").isshown="true";
    }

    function toggleCart(button) {
        if (button.isshown == 'true') {
            document.querySelector(".cart table").style.display="none";
            button.isshown='false';
            button.textContent = "Show Cart";
        } else {
            document.querySelector(".cart table").style.display="";
            button.isshown='true';
            button.textContent = "Hide Cart";
        }
        calculateCartItems();
    }

    function removeItemFromCart(button) {
        var trEl = button.parentNode.parentNode;
        trEl.setAttribute("iscurrent", "true");
        var qtyToRemove = Number(document.querySelector("tr[iscurrent='true'] input").value);
        var qtySelectedEl = document.querySelector("tr[iscurrent='true'] td:nth-child(3)");
        var qtySelected = Number(qtySelectedEl.textContent);
        if (isNaN(qtyToRemove) || qtyToRemove == 0 || qtyToRemove>=qtySelected) {
            if (confirm("Are you sure you want to remove this item ?")) {
                trEl.parentNode.removeChild(trEl);
            }
        } else {
            qtySelectedEl.textContent = (qtySelected-qtyToRemove);
        }
        calculateCartItems();
    }

    function calculateCartItems() {
        var items = document.querySelectorAll(".cart [pid]");
        var trQtyEls = document.querySelectorAll(".cart tbody tr[pid] td:nth-child(3)");
        var trValEls = document.querySelectorAll(".cart tbody tr[pid] td:nth-child(4)");
        var sum = 0;
        for (var i=0; i<items.length; i++) {
            var qty = Number(trQtyEls[i].textContent);
            var unitPrice = Number(trQtyEls[i].getAttribute("unitprice"));
            if (isNaN(qty) || isNaN(unitPrice)) {
                document.getElementById("cartTotal").textContent="Error!";
                return;
            } else {

                trValEls[i].textContent = "$" + (qty*unitPrice);
            }
            sum += (qty * unitPrice);
        }
        var discount = getDiscountValue();
        var sum = sum - (sum*discount/100);
        document.getElementById("cartTotal").textContent="$"+sum;
    }

    function getDiscountValue() {
        var coupon = document.querySelector(".cart input.coupon");
        if (coupon.value) {
            return 10;
        }
        return 0;
    }

    function addItemToCart(button) {
        var itemContainerEl = button.parentNode;
        itemContainerEl.setAttribute("iscurrentitem", "true");
        var pid = itemContainerEl.getAttribute("productid");
        var qtyToAdd = Number(document.querySelector(".product_container[productid='" + pid + "'] input").value);
        var cartItem = document.querySelector(".cart tr[pid='" + pid + "']");
        var price = document.querySelector(".product_container[productid='" + pid + "'] .itemPrice").textContent.substr(1);
        if (cartItem) {
            cartItem.childNodes[2].textContent = Number(cartItem.childNodes[2].textContent) + qtyToAdd;
            cartItem.childNodes[3].textContent = "$" + (Number(cartItem.childNodes[2].textContent)*Number(price));
        } else {
            // create new entry in cart
            var itemName = document.querySelector(".product_container[productid='" + pid + "'] .itemName").textContent;
            var cart = document.querySelector(".cart table tbody");
            var newItem = document.createElement("tr");
            cart.insertBefore(newItem, cart.childNodes[0]);
            newItem.innerHTML = "<td><button onclick='removeItemFromCart(this)'>Remove</button><input type='text' class='qty'></td><td>" + itemName + "</td><td unitprice='" + price + "'>" + qtyToAdd + "</td><td>$" + (qtyToAdd*price) + "</td>";
            newItem.setAttribute("pid", pid);
        }
        calculateCartItems();
    }

    calculateCartItems();
</script>

</body>
</html> 